<?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >  
<mapper namespace="com.enn.commodity.synergistic.dao.IPDao" >  

<resultMap type="com.enn.commodity.synergistic.entity.ResultMap" id="ResultMap">
		
		<result property="arrangement_id" column="arrangement_id"/>
		<result property="po_id" column="po_id"/>
		<result property="billoflading_id" column="billoflading_id"/>
</resultMap>

  <resultMap type="com.enn.commodity.synergistic.entity.IP" id="ipResultMap">
		<id property="id" column="ip_id"/>
		<result property="version" column="ip_version"/>
		<result property="name" column="ip_name"/>
		<result property="comments" column="ip_comments"/>
		<result property="organizationId" column="ip_organizationId"/>
		<result property="organizationName" column="ip_organizationName"/>
		<result property="userId" column="ip_userId"/>
		<result property="userName" column="ip_userName"/>
		<result property="privateId" column="ip_privateId"/>
		<result property="dataType" column="ip_dataType"/>
		<result property="goodsType" column="ip_goodsType"/>
		<result property="contactID" column="ip_contactID"/>
		<result property="contactName" column="ip_contactName"/>
		<result property="contactPhone" column="ip_contactPhone"/>
		<result property="loginUser" column="ip_loginUser"/>
		<result property="loginPass" column="ip_loginPass"/>
		<result property="legal" column="ip_legal"/>
		<result property="registeredLocation" column="ip_registeredLocation"/>
		<result property="scopeOfBusiness" column="ip_scopeOfBusiness"/>
		<result property="registeredCapital" column="ip_registeredCapital"/>
		<result property="abbreviation" column="ip_abbreviation"/>
		<result property="publicKey" column="ip_publicKey"/>
	
		<collection property="product" ofType="com.enn.commodity.synergistic.entity.Product">
			<id property="id" column="product_id"/>
			<result property="version" column="product_version"/>
			<result property="name" column="product_name"/>
			<result property="comments" column="product_comments"/>
			<result property="organizationId" column="product_organizationId"/>
			<result property="organizationName" column="product_organizationName"/>
			<result property="userId" column="product_userId"/>
			<result property="userName" column="product_userName"/>
			<result property="privateId" column="product_privateId"/>
			<result property="dataType" column="product_dataType"/>
			<result property="goodsType" column="product_goodsType"/>
			<result property="type" column="product_type"/>
			<result property="content" column="product_content"/>
			<result property="price" column="product_price"/>
			<result property="priceDate" column="product_priceDate"/>
			<result property="customerProductId" column="product_customerProductId"/>
		</collection>
		
		<collection property="location" ofType="com.enn.commodity.synergistic.entity.Location">
			
			<result property="address" column="location_address"/>
			<result property="contactName" column="location_contactName"/>
			<result property="contactPhone" column="location_contactPhone"/>
			
		</collection>
		
		<collection property="ability" ofType="com.enn.commodity.synergistic.entity.Ability">
			
			<result property="name" column="ability_name"/>
			<result property="value" column="ability_value"/>
			<result property="ipId" column="ability_ipId"/>
			
		</collection>
	</resultMap>


        

 <select id="SelectIPByObject" resultMap="ipResultMap" parameterType="com.enn.commodity.synergistic.entity.IP">
     SELECT *
     FROM ip i
     	LEFT JOIN product p
			ON i.ip_id = p.product_ipId
     	LEFT JOIN location l
			ON i.ip_id=l.location_ipId
		LEFT JOIN ability a
		    ON i.ip_id = a.ability_ipId
     WHERE 1=1
     <if test="id!=null and id!=''" >
     and i.ip_id=#{id}
    </if>
    <if test="name!=null and name!=''" >
     and i.ip_name=#{name}
    </if>
    <if test="version!=null and version!=''" >
     and i.ip_version=#{version}
    </if>
    <if test="comments!=null and comments!=''" >
     and i.ip_comments=#{comments}
    </if>
    <if test="organizationId!=null and organizationId!=''" >
     and i.ip_organizationId=#{organizationId}
    </if>
    <if test="organizationName!=null and organizationName!=''" >
     and i.ip_organizationName=#{organizationName}
    </if>
    <if test="userId!=null and userId!=''" >
     and i.ip_userId=#{userId}
    </if>
    <if test="userName!=null and userName!=''" >
     and i.ip_userName=#{userName}
    </if>
    <if test="privateId!=null and privateId!=''" >
     and i.ip_privateId=#{privateId}
    </if>
    <if test="dataType!=null and dataType!=''" >
     and i.ip_dataType=#{dataType}
    </if>
    <if test="goodsType!=null and goodsType!=''" >
     and i.ip_goodsType=#{goodsType}
    </if>
    <if test="contactID!=null and contactID!=''" >
     and i.ip_contactID=#{contactID}
    </if>
    <if test="contactName!=null and contactName!=''" >
     and i.ip_contactName=#{contactName}
    </if>
    <if test="contactPhone!=null and contactPhone!=''" >
     and i.ip_contactPhone=#{contactPhone}
    </if>
    <if test="loginUser!=null and loginUser!=''" >
     and i.ip_loginUser=#{loginUser}
    </if>
    <if test="loginPass!=null and loginPass!=''" >
     and i.ip_loginPass=#{loginPass}
    </if>
    <if test="legal!=null and legal!=''" >
     and i.ip_legal=#{legal}
    </if>
    <if test="registeredLocation!=null and registeredLocation!=''" >
     and i.ip_registeredLocation=#{registeredLocation}
    </if>
    <if test="scopeOfBusiness!=null and scopeOfBusiness!=''" >
     and i.ip_scopeOfBusiness=#{scopeOfBusiness}
    </if>
    <if test="registeredCapital!=null and registeredCapital!=''" >
     and i.ip_registeredCapital=#{registeredCapital}
    </if>
    <if test="abbreviation!=null and abbreviation!=''" >
     and i.ip_abbreviation=#{abbreviation}
    </if>
    <if test="publicKey!=null and publicKey!=''" >
     and i.ip_publicKey=#{publicKey}
    </if>
    

  </select>
 
 
 <insert id="CreateIP"  keyColumn="ip_id" parameterType="com.enn.commodity.synergistic.entity.IP">
    insert into ip 
    (ip_id,ip_version,ip_name,ip_comments,ip_organizationId,ip_organizationName,
    ip_userId,ip_userName,ip_privateId,ip_dataType,ip_goodsType,ip_contactID,
    ip_contactName,ip_contactPhone,ip_loginUser,ip_loginPass,ip_legal,ip_registeredLocation,ip_scopeOfBusiness,ip_registeredCapital,ip_abbreviation,ip_publicKey) 
    values
    (#{id},#{version},#{name},#{comments},#{organizationId},#{organizationName},#{userId},
    #{userName},#{privateId},#{dataType},#{goodsType},#{contactID},#{contactName},#{contactPhone},#{loginUser},#{loginPass},
    #{legal},#{registeredLocation},#{scopeOfBusiness},#{registeredCapital},#{abbreviation},#{publicKey})
  </insert>
  
  <insert id="CreateProduct"  keyColumn="product_id" parameterType="com.enn.commodity.synergistic.entity.Product">
    insert into product 
    (product_id,product_version,product_name,product_comments,product_organizationId,product_organizationName,
    product_userId,product_userName,product_privateId,product_dataType,product_goodsType,product_type,
    product_content,product_price,product_customerProductId,product_ipId,product_priceDate) 
    values
    (#{id},#{version},#{name},#{comments},#{organizationId},#{organizationName},#{userId},
    #{userName},#{privateId},#{dataType},#{goodsType},#{type},#{content},#{price},#{customerProductId},#{ipId},#{priceDate})
  </insert>
  
  <insert id="CreateLocation"  keyColumn="location_address" parameterType="com.enn.commodity.synergistic.entity.Location">
     insert into location 
    (location_address,location_contactName,location_contactPhone,location_ipId) 
    values
    (#{address},#{contactName},#{contactPhone},#{ipId})
  </insert>
  
  <insert id="CreateAbility"  parameterType="com.enn.commodity.synergistic.entity.Ability">
     insert into ability 
    (ability_name,ability_value,ability_ipId) 
    values
    ('Arrangement','false',#{ipId}),
    ('BillOfLading','false',#{ipId}),
    ('PO','false',#{ipId}),
    ('PackingList','false',#{ipId})
  </insert>
  
  <select id="SelectInfoByObject" resultType="java.util.Map" parameterType="com.enn.commodity.synergistic.entity.IP">
    SELECT * FROM arrangement arr

LEFT JOIN billoflading bill ON arr.arrangement_buyerId=bill.billoflading_buyerId

LEFT JOIN po p ON arr.arrangement_buyerId=p.po_buyerId



WHERE arr.arrangement_buyerId=#{id}


    

  </select>
  
  <update id="UpdateAbility" parameterType="com.enn.commodity.synergistic.entity.Ability">
     UPDATE ability
     <set>
       
      ability_value=#{value}
       
     </set>
     WHERE ability_name=#{name} AND ability_ipId=#{ipId}
  </update>
  <!-- <select id="queryAresById" resultType="com.yaw.demo.entity.Area">
     SELECT areaId,areaName,priority,createTime,lastEditTime
     FROM area
     WHERE areaId=#{areaId}
  </select>
  
  <insert id="insertArea" useGeneratedKeys="true" keyProperty="areaId" keyColumn="areaId" parameterType="com.yaw.demo.entity.Area">
    insert into area (areaName,priority,createTime,lastEditTime) values(#{areaName},#{priority},#{createTime},#{lastEditTime})
  </insert>
  
  
  
  <delete id="deleteArea">
     DELETE FROM
     area
     WHERE
     areaId=#{areaId}
  </delete> -->
</mapper>